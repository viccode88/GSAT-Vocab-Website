# å­¸æ¸¬é«˜é »å–®å­—æ¢ç´¢ç³»çµ± - å®Œæ•´æŠ€è¡“æ¶æ§‹æ–‡æª”

## ğŸ“‹ ç›®éŒ„
- [ç³»çµ±æ¦‚è¿°](#ç³»çµ±æ¦‚è¿°)
- [ç³»çµ±æ¶æ§‹åœ–](#ç³»çµ±æ¶æ§‹åœ–)
- [æŠ€è¡“å †ç–Š](#æŠ€è¡“å †ç–Š)
- [è³‡æ–™è™•ç†æµç¨‹](#è³‡æ–™è™•ç†æµç¨‹)
- [éƒ¨ç½²æ¶æ§‹](#éƒ¨ç½²æ¶æ§‹)
- [è©³ç´°æ¨¡çµ„èªªæ˜](#è©³ç´°æ¨¡çµ„èªªæ˜)
- [API èˆ‡æ•´åˆ](#api-èˆ‡æ•´åˆ)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [æˆæœ¬ä¼°ç®—](#æˆæœ¬ä¼°ç®—)

---

## ç³»çµ±æ¦‚è¿°

**å­¸æ¸¬é«˜é »å–®å­—æ¢ç´¢ç³»çµ±**æ˜¯ä¸€å€‹å…¨è‡ªå‹•åŒ–çš„è‹±æ–‡å–®å­—å­¸ç¿’å¹³å°ï¼Œå¾æ­·å±†å­¸æ¸¬è©¦é¡Œä¸­æå–ã€åˆ†æä¸¦å‘ˆç¾é«˜é »å–®å­—ï¼Œæä¾›å®Œæ•´çš„å–®å­—é‡‹ç¾©ã€ä¾‹å¥ã€è©æ€§åˆ†å¸ƒä»¥åŠçœŸäººç™¼éŸ³åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹è‰²
- âœ… **è‡ªå‹•åŒ–è³‡æ–™æ”¶é›†**: å¾å¤§è€ƒä¸­å¿ƒå®˜ç¶²è‡ªå‹•çˆ¬å–æ­·å±†è©¦é¡Œ
- âœ… **AI é©…å‹•çš„å…§å®¹ç”Ÿæˆ**: ä½¿ç”¨ OpenAI GPT æ¨¡å‹ç”Ÿæˆé‡‹ç¾©èˆ‡ä¾‹å¥
- âœ… **é«˜å“è³ªèªéŸ³**: ä½¿ç”¨ OpenAI TTS API ç”Ÿæˆè‡ªç„¶èªéŸ³
- âœ… **ç„¡ä¼ºæœå™¨æ¶æ§‹**: å®Œå…¨éƒ¨ç½²æ–¼ Cloudflare ç”Ÿæ…‹ç³»çµ±
- âœ… **é«˜æ•ˆèƒ½**: åˆ©ç”¨ R2 å„²å­˜èˆ‡å…¨çƒ CDN åˆ†ç™¼
- âœ… **ç¾ä»£åŒ– UI**: éŸ¿æ‡‰å¼è¨­è¨ˆï¼Œæ”¯æ´æ¡Œé¢èˆ‡è¡Œå‹•è£ç½®

---

## ç³»çµ±æ¶æ§‹åœ–

### 1. æ•´é«”ç³»çµ±æµç¨‹åœ–

```mermaid
flowchart TB
    subgraph "è³‡æ–™æ”¶é›†éšæ®µ"
        A[å¤§è€ƒä¸­å¿ƒç¶²ç«™] -->|çˆ¬èŸ²æŠ“å–| B[PDF è©¦é¡Œæª”æ¡ˆ]
        B -->|ceec_scraper.py| C[æœ¬åœ° PDF å„²å­˜]
    end
    
    subgraph "è³‡æ–™è™•ç†éšæ®µ"
        C -->|extract_words.py| D[PDF æ–‡å­—æå–]
        D -->|pdfplumber| E[åŸå§‹æ–‡å­—æª”]
        E -->|spaCy NLP| F[è©æ€§æ¨™è¨» & è©å½¢é‚„åŸ]
        F -->|OpenAI API| G[AI é‡‹ç¾©ç”Ÿæˆ]
        G -->|çµ±è¨ˆæ’åº| H[vocab_data.json]
    end
    
    subgraph "è³‡æ–™å„ªåŒ–éšæ®µ"
        H -->|json_edt.py| I[äººå·¥ç·¨è¼¯/ç¯©é¸]
        I -->|enerate_tts_audio.py| J[TTS éŸ³é »ç”Ÿæˆ]
        J -->|OpenAI TTS API| K[MP3 éŸ³é »æª”æ¡ˆ]
    end
    
    subgraph "éƒ¨ç½²éšæ®µ"
        K -->|r2_up.py| L[Cloudflare R2 Storage]
        H -->|Git Push| M[Cloudflare Pages]
        N[worker.js] -->|è®€å–éŸ³é »| L
    end
    
    subgraph "ä½¿ç”¨è€…ç«¯"
        O[ç€è¦½å™¨] -->|HTTPS| M
        M -->|è¼‰å…¥| P[index.html]
        P -->|æ’­æ”¾éŸ³é »| N
        N -->|å›å‚³ MP3| P
    end
    
    style A fill:#e1f5ff
    style M fill:#fff9c4
    style L fill:#fff9c4
    style N fill:#fff9c4
    style O fill:#c8e6c9
    style P fill:#c8e6c9
```

### 2. Cloudflare éƒ¨ç½²æ¶æ§‹

```mermaid
graph TB
    subgraph "ä½¿ç”¨è€…ç«¯"
        User[ğŸŒ ä½¿ç”¨è€…ç€è¦½å™¨]
    end
    
    subgraph "Cloudflare å…¨çƒç¶²è·¯"
        CDN[âš¡ Cloudflare CDN Edge]
    end
    
    subgraph "Cloudflare Pages"
        Pages[ğŸ“„ éœæ…‹ç¶²ç«™è¨—ç®¡<br/>index.html + vocab_data.json]
    end
    
    subgraph "Cloudflare Workers"
        Worker[âš™ï¸ Worker API<br/>worker.js<br/>éŸ³é »ä»£ç†æœå‹™]
    end
    
    subgraph "Cloudflare R2"
        R2[(ğŸ—„ï¸ R2 Object Storage<br/>5,896 å€‹ MP3 æª”æ¡ˆ)]
    end
    
    User -->|1. è¨ªå•ç¶²ç«™| CDN
    CDN -->|2. åˆ†ç™¼éœæ…‹è³‡æº| Pages
    Pages -->|3. å›å‚³ HTML/JSON| User
    User -->|4. è«‹æ±‚éŸ³é »<br/>GET /word.mp3| Worker
    Worker -->|5. è®€å–æª”æ¡ˆ| R2
    R2 -->|6. å›å‚³ MP3 ä¸²æµ| Worker
    Worker -->|7. å›å‚³éŸ³é »<br/>Cache 30å¤©| User
    
    style User fill:#4fc3f7
    style CDN fill:#ffd54f
    style Pages fill:#81c784
    style Worker fill:#ff8a65
    style R2 fill:#ba68c8
```

### 3. è³‡æ–™è™•ç†ç®¡ç·š

```mermaid
sequenceDiagram
    participant PDF as PDF è©¦é¡Œ
    participant Extractor as extract_words.py
    participant spaCy as spaCy NLP Engine
    participant OpenAI as OpenAI API
    participant DB as vocab_data.json
    
    PDF->>Extractor: è¼¸å…¥ 32 ä»½ PDF
    Extractor->>Extractor: pdfplumber æå–æ–‡å­—
    Extractor->>spaCy: ç™¼é€æ–‡å­—é€²è¡Œ NLP
    spaCy->>spaCy: åˆ†è©ã€è©æ€§æ¨™è¨»ã€è©å½¢é‚„åŸ
    spaCy->>Extractor: å›å‚³çµæ§‹åŒ–è³‡æ–™
    Extractor->>Extractor: çµ±è¨ˆè©é »ã€éæ¿¾åœç”¨è©
    
    loop ä¸¦ç™¼è™•ç†æ¯å€‹å–®å­—
        Extractor->>OpenAI: è«‹æ±‚é‡‹ç¾© (477 ä¸¦ç™¼)
        OpenAI->>Extractor: å›å‚³ä¸­è‹±æ–‡é‡‹ç¾© + ä¾‹å¥
    end
    
    Extractor->>DB: è¼¸å‡ºå®Œæ•´ JSON
    Note over DB: åŒ…å«è©é »ã€è©æ€§ã€<br/>ä¾‹å¥ã€é‡‹ç¾©
```

### 4. å‰ç«¯æ¶æ§‹æµç¨‹

```mermaid
stateDiagram-v2
    [*] --> è¼‰å…¥æ‡‰ç”¨
    è¼‰å…¥æ‡‰ç”¨ --> åˆå§‹åŒ–: DOMContentLoaded
    åˆå§‹åŒ– --> è¼‰å…¥è³‡æ–™: fetch vocab_data.json
    è¼‰å…¥è³‡æ–™ --> å¾…æ©Ÿç‹€æ…‹: è³‡æ–™è¼‰å…¥æˆåŠŸ
    
    å¾…æ©Ÿç‹€æ…‹ --> æœå°‹æ¨¡å¼: ä½¿ç”¨è€…è¼¸å…¥æœå°‹
    å¾…æ©Ÿç‹€æ…‹ --> ç¯©é¸æ¨¡å¼: é»æ“Šç¯©é¸æŒ‰éˆ•
    å¾…æ©Ÿç‹€æ…‹ --> ç€è¦½æ¨¡å¼: åˆ‡æ›ç¶²æ ¼è¦–åœ–
    å¾…æ©Ÿç‹€æ…‹ --> éš¨æ©Ÿå–®å­—: é»æ“Šéš¨æ©ŸæŒ‰éˆ•
    
    æœå°‹æ¨¡å¼ --> é¡¯ç¤ºåˆ—è¡¨: é˜²æŠ–è™•ç† (300ms)
    ç¯©é¸æ¨¡å¼ --> é¡¯ç¤ºåˆ—è¡¨: æ‡‰ç”¨ç¯©é¸æ¢ä»¶
    ç€è¦½æ¨¡å¼ --> ç¶²æ ¼è¦–åœ–: åˆ‡æ›é¡¯ç¤ºæ¨¡å¼
    éš¨æ©Ÿå–®å­— --> è©³ç´°é é¢: éš¨æ©Ÿé¸æ“‡å–®å­—
    
    é¡¯ç¤ºåˆ—è¡¨ --> è©³ç´°é é¢: é»æ“Šå–®å­—
    ç¶²æ ¼è¦–åœ– --> é¡¯ç¤º Tooltip: æ»‘é¼ æ‡¸åœ
    ç¶²æ ¼è¦–åœ– --> è©³ç´°é é¢: é»æ“Šå–®å­—
    
    è©³ç´°é é¢ --> æ’­æ”¾éŸ³é »: é»æ“Šæ’­æ”¾æŒ‰éˆ•
    æ’­æ”¾éŸ³é » --> Workerè«‹æ±‚: è«‹æ±‚ MP3
    Workerè«‹æ±‚ --> æ’­æ”¾éŸ³é »: å›å‚³éŸ³é »
    
    è©³ç´°é é¢ --> å¾…æ©Ÿç‹€æ…‹: è¿”å›åˆ—è¡¨
    é¡¯ç¤º Tooltip --> ç¶²æ ¼è¦–åœ–: æ»‘é¼ é›¢é–‹
```

---

## æŠ€è¡“å †ç–Š

### å¾Œç«¯è³‡æ–™è™•ç† (Python)
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.10+ | ä¸»è¦é–‹ç™¼èªè¨€ |
| pdfplumber | Latest | PDF æ–‡å­—æå– |
| spaCy | Latest | è‡ªç„¶èªè¨€è™•ç† |
| en_core_web_sm | Latest | è‹±æ–‡ NLP æ¨¡å‹ |
| OpenAI Python SDK | Latest | API æ•´åˆ |
| boto3 | Latest | AWS S3 ç›¸å®¹ API (R2) |
| requests | Latest | HTTP è«‹æ±‚ |
| BeautifulSoup4 | Latest | HTML è§£æ |
| tqdm | Latest | é€²åº¦æ¢é¡¯ç¤º |

### å‰ç«¯ (JavaScript)
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vanilla JavaScript | ES6+ | å‰ç«¯é‚è¼¯ |
| Tailwind CSS | 3.x (CDN) | UI æ¨£å¼æ¡†æ¶ |
| Google Fonts | - | å­—å‹ (Inter, Noto Sans TC) |
| HTML5 Audio API | - | éŸ³é »æ’­æ”¾ |

### é›²ç«¯æœå‹™ (Cloudflare)
| æœå‹™ | ç”¨é€” | è¨ˆåƒ¹æ–¹å¼ |
|------|------|----------|
| Cloudflare Pages | éœæ…‹ç¶²ç«™è¨—ç®¡ | å…è²» (ç„¡é™è«‹æ±‚) |
| Cloudflare Workers | éŸ³é » API ç«¯é» | å…è²»é¡åº¦: 100k req/day |
| Cloudflare R2 | ç‰©ä»¶å„²å­˜ | å…è²»é¡åº¦: 10GB å„²å­˜ |

### AI æœå‹™ (OpenAI)
| API | æ¨¡å‹ | ç”¨é€” |
|-----|------|------|
| Chat Completions | gpt-4o-mini | ç”Ÿæˆé‡‹ç¾©èˆ‡ä¾‹å¥ |
| Text-to-Speech | gpt-4o-mini-tts | ç”Ÿæˆå–®å­—ç™¼éŸ³ |

---

## è³‡æ–™è™•ç†æµç¨‹

### éšæ®µ 1: è³‡æ–™æ”¶é›† (`ceec_scraper.py`)

**ç›®æ¨™**: å¾å¤§è€ƒä¸­å¿ƒç¶²ç«™è‡ªå‹•ä¸‹è¼‰æ­·å±†å­¸æ¸¬è‹±æ–‡è©¦é¡Œ PDF

```python
# æ ¸å¿ƒåŠŸèƒ½
1. ç™¼é€ HTTP è«‹æ±‚è‡³å¤§è€ƒä¸­å¿ƒè©¦é¡Œè³‡æ–™åº«
2. è§£æ HTMLï¼Œæå–è©¦é¡Œé€£çµ
3. éæ¿¾å‡ºã€Œè‹±æ–‡ç§‘è©¦é¡Œå·ã€(æ’é™¤ç­”é¡Œå·ã€è§£ç­”)
4. æ‰¹æ¬¡ä¸‹è¼‰ PDF ä¸¦é‡æ–°å‘½å
5. è‡ªå‹•å»é‡ï¼Œé¿å…é‡è¤‡ä¸‹è¼‰
```

**è¼¸å‡º**: 
- 32 ä»½ PDF æª”æ¡ˆ (1994-2025 å¹´å­¸æ¸¬è©¦é¡Œ)
- å‘½åæ ¼å¼: `{è¥¿å…ƒå¹´}_{æ°‘åœ‹å¹´}_{åŸå§‹æª”å}.pdf`

**æŠ€è¡“äº®é»**:
- âœ… ä½¿ç”¨æ­£è¦è¡¨é”å¼ç²¾æº–åŒ¹é…ã€Œè©¦é¡Œå·ã€
- âœ… è‡ªå‹•åˆ†é æŠ“å–ï¼Œç›´åˆ°æ²’æœ‰æ–°æª”æ¡ˆç‚ºæ­¢
- âœ… é‡è©¦æ©Ÿåˆ¶è™•ç†ç¶²è·¯éŒ¯èª¤
- âœ… é€²åº¦æ¢é¡¯ç¤ºä¸‹è¼‰ç‹€æ…‹

---

### éšæ®µ 2: NLP åˆ†æèˆ‡ AI é‡‹ç¾© (`extract_words.py`)

é€™æ˜¯æ•´å€‹ç³»çµ±æœ€æ ¸å¿ƒçš„æ¨¡çµ„ï¼ŒåŒ…å«ä¸‰å€‹å­éšæ®µ:

#### 2.1 PDF æ–‡å­—æå–

```python
# ä½¿ç”¨ pdfplumber æå–æ–‡å­—
def extract_text_from_pdf(pdf_file: Path) -> str:
    with pdfplumber.open(pdf_file) as pdf:
        text = "\n".join(
            p.extract_text(x_tolerance=2, y_tolerance=2) or "" 
            for p in pdf.pages
        )
    return text
```

**è™•ç†é‚è¼¯**:
1. é€é æå–æ–‡å­—å…§å®¹
2. ä¿ç•™åŸå§‹æ’ç‰ˆè³‡è¨Š
3. å„²å­˜ç‚º `.txt` æª”æ¡ˆå‚™ä»½

**è¼¸å‡º**: `data/raw_txt/` è³‡æ–™å¤¾ä¸­çš„ 32 å€‹æ–‡å­—æª”

---

#### 2.2 spaCy NLP è™•ç†

```python
# è¼‰å…¥ spaCy æ¨¡å‹
nlp = spacy.load("en_core_web_sm", disable=["ner"])

# è™•ç†æ–‡å­—
doc = nlp(raw_text)
for sent in doc.sents:
    for token in sent:
        lemma = token.lemma_.lower()  # è©å½¢é‚„åŸ
        pos = token.pos_              # è©æ€§æ¨™è¨»
```

**è™•ç†å…§å®¹**:
1. **åˆ†è© (Tokenization)**: å°‡æ–‡å­—åˆ‡åˆ†ç‚ºå–®å­—
2. **è©æ€§æ¨™è¨» (POS Tagging)**: åˆ¤æ–·åè©ã€å‹•è©ã€å½¢å®¹è©ç­‰
3. **è©å½¢é‚„åŸ (Lemmatization)**: å°‡è®ŠåŒ–å½¢é‚„åŸç‚ºåŸå½¢
   - `running` â†’ `run`
   - `better` â†’ `good`
4. **å¥å­åˆ†å‰²**: æå–åŒ…å«è©²å–®å­—çš„å®Œæ•´å¥å­

**éæ¿¾è¦å‰‡**:
```python
# æ’é™¤çš„è©æ€§
STOP_POS = {"ADP", "AUX", "CONJ", "DET", "NUM", "PART", "PRON", ...}

# è‡ªè¨‚åœç”¨è©
CUSTOM_STOP_WORDS = {'be', 'have', 'do', 'say', 'get', ...}

# å¥å­éæ¿¾
- å°‘æ–¼ 5 å€‹å–®å­—çš„å¥å­
- é ç¢¼ã€ç« ç¯€æ¨™é¡Œ
- é¸é …æ¨™è¨˜ (A)(B)(C)(D)
- å¤§å¯«å­—æ¯è¶…é 70% çš„å¥å­ (å¯èƒ½æ˜¯æ¨™é¡Œ)
```

**è³‡æ–™çµæ§‹**:
```python
vocab_data = {
    "lemma": {
        "count": 125,              # å‡ºç¾æ¬¡æ•¸
        "pos_dist": {              # è©æ€§åˆ†å¸ƒ
            "NOUN": 80,
            "VERB": 45
        },
        "sentences": [             # ä¾‹å¥ (æœ€å¤š 5 å€‹)
            "[2024_113] The environment is crucial...",
            "[2023_112] Environmental protection..."
        ]
    }
}
```

---

#### 2.3 OpenAI API é‡‹ç¾©ç”Ÿæˆ

**ä¸¦ç™¼æ¶æ§‹è¨­è¨ˆ**:

```python
# ä½¿ç”¨ asyncio + Semaphore æ§åˆ¶ä¸¦ç™¼
CONCURRENT_REQUESTS = 477  # åŒæ™‚ 477 å€‹è«‹æ±‚
semaphore = asyncio.Semaphore(CONCURRENT_REQUESTS)

async def fetch_single_definition(lemma, system_prompt, semaphore):
    async with semaphore:
        response = await client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": lemma}
            ],
            response_format={"type": "json_object"},
            temperature=0.2
        )
```

**System Prompt**:
```
You are an expert lexicographer. For the English word provided by the user,
give a concise definition in both Traditional Chinese and English, and one 
simple example sentence in English. Respond ONLY with a single, valid JSON 
object with three keys: 'zh_def', 'en_def', and 'example'.
```

**å›æ‡‰æ ¼å¼**:
```json
{
  "zh_def": "ç’°å¢ƒï¼›å‘¨åœçš„äº‹ç‰©æˆ–æƒ…æ³",
  "en_def": "The surroundings or conditions in which a person, animal, or plant lives or operates",
  "example": "We must protect the environment for future generations."
}
```

**æ•ˆèƒ½å„ªåŒ–**:
- âœ… **ä¸¦ç™¼è«‹æ±‚**: 477 å€‹è«‹æ±‚åŒæ™‚é€²è¡Œ
- âœ… **é€²åº¦è¿½è¹¤**: ä½¿ç”¨ tqdm é¡¯ç¤ºå³æ™‚é€²åº¦
- âœ… **éŒ¯èª¤è™•ç†**: Rate Limit è‡ªå‹•é‡è©¦ (ç­‰å¾… 10 ç§’)
- âœ… **è¶…æ™‚è¨­å®š**: 20 ç§’è¶…æ™‚é¿å…å¡æ­»

**è¼¸å‡º**: `data/output/vocab_data.json` (å®Œæ•´çš„å–®å­—è³‡æ–™åº«)

---

### éšæ®µ 3: è³‡æ–™ç·¨è¼¯ (`json_edt.py`)

æä¾›äº’å‹•å¼å‘½ä»¤åˆ—å·¥å…·ï¼Œç”¨æ–¼æ‰‹å‹•ç·¨è¼¯å–®å­—è³‡æ–™:

**åŠŸèƒ½**:
1. **æŸ¥çœ‹å–®å­—è©³ç´°è³‡è¨Š**: è¼¸å…¥å–®å­—åç¨±æŸ¥çœ‹å®Œæ•´ JSON
2. **åˆªé™¤å–®ä¸€å–®å­—**: ç¢ºèªå¾Œåˆªé™¤
3. **æ‰¹æ¬¡åˆªé™¤**: è¼¸å…¥ `word1,word2,word3` æ‰¹æ¬¡åˆªé™¤
4. **åŒ¯å‡ºå–®å­—åˆ—è¡¨**: è¼¸å‡ºç´”æ–‡å­—æª”æ¡ˆ (æ¯è¡Œä¸€å€‹å–®å­—)

**ä½¿ç”¨æƒ…å¢ƒ**:
- ç§»é™¤ç„¡æ„ç¾©çš„å–®å­— (å¦‚äººåã€åœ°å)
- åˆªé™¤éŒ¯èª¤è§£æçš„è©å½™
- èª¿æ•´å–®å­—åˆ—è¡¨

---

### éšæ®µ 4: TTS éŸ³é »ç”Ÿæˆ (`enerate_tts_audio.py`)

**ç›®æ¨™**: ç‚ºæ¯å€‹å–®å­—ç”Ÿæˆé«˜å“è³ªçš„ MP3 ç™¼éŸ³æª”

**OpenAI TTS API æ•´åˆ**:

```python
# ä½¿ç”¨å®˜æ–¹æ¨è–¦çš„ streaming çµæ§‹
async with client.audio.speech.with_streaming_response.create(
    model="gpt-4o-mini-tts",
    voice="onyx",              # ç”·è²ï¼Œæ¸…æ™°ç©©é‡
    input=word,
    response_format="mp3"
) as response:
    await response.stream_to_file(output_file)
```

**é…ç½®åƒæ•¸**:
- **æ¨¡å‹**: `gpt-4o-mini-tts` (æ€§åƒ¹æ¯”æœ€é«˜)
- **èªéŸ³**: `onyx` (ç”·è²ï¼Œé©åˆå–®å­—ç™¼éŸ³)
- **æ ¼å¼**: MP3 (é«˜å£“ç¸®æ¯”ï¼Œé©åˆç¶²è·¯å‚³è¼¸)
- **ä¸¦ç™¼æ•¸**: 15 (é¿å…è§¸ç™¼ Rate Limit)
- **é‡è©¦æ¬¡æ•¸**: 3 æ¬¡

**æ•ˆèƒ½ç‰¹æ€§**:
- âœ… **æ–·é»çºŒå‚³**: è‡ªå‹•è·³éå·²å­˜åœ¨çš„æª”æ¡ˆ
- âœ… **ä¸¦ç™¼è™•ç†**: 15 å€‹è«‹æ±‚åŒæ™‚é€²è¡Œ
- âœ… **æŒ‡æ•¸é€€é¿**: Rate Limit æ™‚è‡ªå‹•å»¶é²é‡è©¦
- âœ… **éŒ¯èª¤å ±å‘Š**: è¨˜éŒ„å¤±æ•—çš„å–®å­—

**è¼¸å‡º**: 
- `data/output/tts_audio/` è³‡æ–™å¤¾
- 5,896 å€‹ MP3 æª”æ¡ˆ
- æª”åæ ¼å¼: `{lemma}.mp3` (ä¾‹å¦‚: `environment.mp3`)

---

### éšæ®µ 5: éŸ³é »ä¸Šå‚³è‡³ R2 (`r2_up.py`)

**Cloudflare R2 ç°¡ä»‹**:
- S3 ç›¸å®¹çš„ç‰©ä»¶å„²å­˜æœå‹™
- **é›¶å‡ºå£è²»ç”¨** (No Egress Fees)
- å…¨çƒ CDN åˆ†ç™¼
- é«˜å¯ç”¨æ€§ã€é«˜è€ä¹…æ€§

**ä¸Šå‚³ç­–ç•¥**:

```python
# ä½¿ç”¨ boto3 S3 ç›¸å®¹ API
s3 = boto3.client(
    's3',
    endpoint_url=f"https://{account_id}.r2.cloudflarestorage.com",
    aws_access_key_id=access_key_id,
    aws_secret_access_key=secret_access_key,
    config=Config(
        retries={
            'max_attempts': 10,    # æœ€å¤šé‡è©¦ 10 æ¬¡
            'mode': 'adaptive'     # è‡ªé©æ‡‰é‡è©¦ (æŒ‡æ•¸é€€é¿)
        }
    )
)

# å¤šåŸ·è¡Œç·’ä¸¦ç™¼ä¸Šå‚³
with ThreadPoolExecutor(max_workers=10) as executor:
    futures = {executor.submit(upload_file, s3, f, bucket): f for f in files}
```

**é…ç½®**:
- **Bucket**: `vocab-audio`
- **ä¸¦ç™¼æ•¸**: 10 å€‹åŸ·è¡Œç·’
- **é‡è©¦ç­–ç•¥**: è‡ªé©æ‡‰æ¨¡å¼ (Adaptive Retry)
- **é€²åº¦è¿½è¹¤**: tqdm é€²åº¦æ¢

**ç’°å¢ƒè®Šæ•¸**:
```bash
R2_ACCOUNT_ID=your_account_id
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
```

---

## éƒ¨ç½²æ¶æ§‹

### Cloudflare Pages (å‰ç«¯è¨—ç®¡)

**éƒ¨ç½²å…§å®¹**:
```
ç™¼è¡Œ/
â”œâ”€â”€ index.html                    # ä¸»æ‡‰ç”¨ç¨‹å¼
â””â”€â”€ data/
    â””â”€â”€ output/
        â””â”€â”€ vocab_data.json       # å–®å­—è³‡æ–™åº« (ç´„ 100MB)
```

**éƒ¨ç½²æ–¹å¼**:
1. å°‡ `ç™¼è¡Œ/` è³‡æ–™å¤¾æ¨é€è‡³ Git å€‰åº«
2. åœ¨ Cloudflare Pages ä¸­é€£çµå€‰åº«
3. è¨­å®šå»ºç½®å‘½ä»¤: (ç„¡éœ€å»ºç½®)
4. è¨­å®šè¼¸å‡ºç›®éŒ„: `ç™¼è¡Œ/`
5. è‡ªå‹•éƒ¨ç½²æˆåŠŸ

**ç‰¹æ€§**:
- âœ… å…¨çƒ CDN åŠ é€Ÿ (275+ è³‡æ–™ä¸­å¿ƒ)
- âœ… è‡ªå‹• HTTPS æ†‘è­‰
- âœ… ç„¡é™é »å¯¬èˆ‡è«‹æ±‚
- âœ… Git æ•´åˆï¼Œæ¨é€å³éƒ¨ç½²
- âœ… é è¦½ç’°å¢ƒ (æ¯å€‹ PR ç¨ç«‹ç¶²å€)

---

### Cloudflare Workers (éŸ³é » API)

**Worker ç¨‹å¼ç¢¼è§£æ** (`worker.js`):

```javascript
export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);
    const objectKey = url.pathname.slice(1); // ç§»é™¤é–‹é ­çš„ "/"
    
    // 1. å®‰å…¨æ€§æª¢æŸ¥
    if (request.method !== 'GET') {
      return new Response('Method Not Allowed', { status: 405 });
    }
    if (!objectKey || !objectKey.endsWith('.mp3')) {
      return new Response('Invalid request', { status: 400 });
    }
    
    // 2. å¾ R2 å–å¾—æª”æ¡ˆ
    const object = await env.AUDIO_BUCKET.get(objectKey);
    if (object === null) {
      return new Response('Object Not Found', { status: 404 });
    }
    
    // 3. è¨­å®šå¿«å–æ¨™é ­
    const headers = new Headers();
    object.writeHttpMetadata(headers);
    headers.set('cache-control', 'public, max-age=2592000'); // 30 å¤©
    
    // 4. å›å‚³éŸ³é »ä¸²æµ
    return new Response(object.body, { headers });
  }
}
```

**é—œéµè¨­è¨ˆ**:

1. **R2 Binding**: 
   - åœ¨ Worker è¨­å®šä¸­ç¶å®š R2 Bucket
   - è®Šæ•¸åç¨±: `AUDIO_BUCKET`
   - Bucket: `vocab-audio`

2. **è«‹æ±‚æµç¨‹**:
   ```
   ç”¨æˆ¶è«‹æ±‚: https://vocab-audio.vic0407lu.workers.dev/environment.mp3
         â†“
   Worker è§£æè·¯å¾‘: environment.mp3
         â†“
   å¾ R2 è®€å–: env.AUDIO_BUCKET.get("environment.mp3")
         â†“
   å›å‚³ä¸²æµ + Cache-Control æ¨™é ­
   ```

3. **å¿«å–ç­–ç•¥**:
   - **Cache-Control**: `public, max-age=2592000` (30 å¤©)
   - **ETag**: è‡ªå‹•ç”± R2 æä¾›ï¼Œæ”¯æ´æ¢ä»¶è«‹æ±‚
   - **é‚Šç·£å¿«å–**: Cloudflare è‡ªå‹•åœ¨é‚Šç·£ç¯€é»å¿«å–

4. **æ•ˆèƒ½å„ªåŒ–**:
   - âœ… **ä¸²æµå‚³è¼¸**: ä¸å°‡æ•´å€‹æª”æ¡ˆè¼‰å…¥è¨˜æ†¶é«”
   - âœ… **é›¶å»¶é²**: åœ¨ R2 åŒæ©Ÿæˆ¿è®€å–
   - âœ… **å…¨çƒåˆ†ç™¼**: å¿«å–åœ¨ 275+ é‚Šç·£ç¯€é»

**Worker è¨­å®š**:
```bash
# wrangler.toml
name = "vocab-audio"
main = "worker.js"
compatibility_date = "2024-01-01"

[[r2_buckets]]
binding = "AUDIO_BUCKET"
bucket_name = "vocab-audio"
```

**éƒ¨ç½²æŒ‡ä»¤**:
```bash
npx wrangler deploy
```

---

### å‰ç«¯æ‡‰ç”¨ç¨‹å¼ (`index.html`)

**æŠ€è¡“æ¶æ§‹**:

1. **å–®é æ‡‰ç”¨ (SPA)**: 
   - ç„¡éœ€æ¡†æ¶ï¼Œç´” Vanilla JavaScript
   - äº‹ä»¶é©…å‹•æ¶æ§‹
   - ç‹€æ…‹ç®¡ç†ç”±é–‰åŒ…è®Šæ•¸å¯¦ç¾

2. **è³‡æ–™æµ**:
   ```
   åˆå§‹åŒ– â†’ fetch vocab_data.json â†’ å„²å­˜è‡³ allWords é™£åˆ—
                                          â†“
                                    æ‡‰ç”¨ç¯©é¸æ¢ä»¶
                                          â†“
                                    filteredWords é™£åˆ—
                                          â†“
                                    æ¸²æŸ“è‡³ DOM
   ```

3. **æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„**:

   **a. æœå°‹èˆ‡ç¯©é¸**:
   ```javascript
   // é˜²æŠ–è™•ç† (300ms)
   searchInput.addEventListener('input', debounce(e => {
       currentFilters.searchTerm = e.target.value.toLowerCase();
       applyFilters();
   }, 300));
   
   // è¤‡åˆç¯©é¸
   function applyFilters() {
       let words = [...allWords];
       
       // æœå°‹è©ç¯©é¸
       if (currentFilters.searchTerm) {
           words = words.filter(w => 
               w.lemma.startsWith(currentFilters.searchTerm)
           );
       }
       
       // é »ç‡ç¯©é¸ (æ ¸å¿ƒ 1-200, å¸¸è¦‹ 201-800, æ›´å¤š 801+)
       if (currentFilters.freq !== 'all') {
           const [min, max] = freqRanges[currentFilters.freq];
           words = words.filter(w => {
               const rank = allWords.findIndex(f => f.lemma === w.lemma) + 1;
               return rank >= min && rank <= max;
           });
       }
       
       // è©æ€§ç¯©é¸
       if (currentFilters.pos !== 'all') {
           words = words.filter(w => 
               Object.keys(w.pos_dist).includes(currentFilters.pos)
           );
       }
       
       filteredWords = words;
       renderWordList();
   }
   ```

   **b. å…©ç¨®é¡¯ç¤ºæ¨¡å¼**:
   
   - **åˆ—è¡¨æ¨¡å¼** (é è¨­):
     ```html
     <div class="list-item">
         <span>environment</span>
         <span class="badge">NOUN</span>
         <span class="count">125</span>
     </div>
     ```
   
   - **ç¶²æ ¼ç€è¦½æ¨¡å¼**:
     ```html
     <div class="browse-cell">environment</div>
     ```
     - Hover é¡¯ç¤º Tooltip
     - CSS Grid è‡ªé©æ‡‰æ’åˆ—
     - é©åˆå¿«é€Ÿç€è¦½å¤§é‡å–®å­—

   **c. éŸ³é »æ’­æ”¾æ•´åˆ**:
   ```javascript
   // å…±ç”¨ Audio ç‰©ä»¶ï¼Œé¿å…é‡è¤‡å»ºç«‹
   let audioPlayer = new Audio();
   
   document.getElementById('play-audio-btn').addEventListener('click', () => {
       const lemma = document.getElementById('detail-lemma').textContent.toLowerCase();
       const workerBaseUrl = 'https://vocab-audio.vic0407lu.workers.dev';
       const audioUrl = `${workerBaseUrl}/${lemma}.mp3`;
       
       audioPlayer.src = audioUrl;
       audioPlayer.play().catch(error => {
           console.error('æ’­æ”¾å¤±æ•—', error);
       });
   });
   ```

   **d. éŸ¿æ‡‰å¼è¨­è¨ˆ**:
   ```css
   /* æ¡Œé¢ç‰ˆ: ä¸‰æ¬„å¼ä½ˆå±€ */
   @media (min-width: 1024px) {
       .control-panel { width: 25%; }
       .word-list { width: 33%; }
       .detail-panel { width: 42%; }
   }
   
   /* è¡Œå‹•ç‰ˆ: å–®æ¬„ + æ»‘å…¥å‹•ç•« */
   @media (max-width: 1023px) {
       #detail-wrapper {
           transform: translateX(100%);
           transition: transform 0.3s ease-in-out;
       }
       .mobile-detail-view-active #detail-wrapper {
           transform: translateX(0);
       }
   }
   ```

4. **æ•ˆèƒ½å„ªåŒ–**:
   - âœ… **é˜²æŠ– (Debounce)**: æœå°‹è¼¸å…¥å»¶é² 300ms åŸ·è¡Œ
   - âœ… **è™›æ“¬æ»¾å‹•**: (æœªå¯¦ä½œï¼Œä½†å¯å„ªåŒ–) å¤§é‡è³‡æ–™æ™‚åªæ¸²æŸ“å¯è¦‹å€åŸŸ
   - âœ… **äº‹ä»¶å§”æ´¾**: åœ¨çˆ¶å®¹å™¨ç›£è½é»æ“Šäº‹ä»¶
   - âœ… **CSS å‹•ç•«**: ä½¿ç”¨ GPU åŠ é€Ÿçš„ transform
   - âœ… **åœ–ç‰‡æ‡¶è¼‰å…¥**: (ç„¡åœ–ç‰‡ï¼ŒN/A)

---

## API èˆ‡æ•´åˆ

### OpenAI API æ•´åˆç´°ç¯€

#### 1. Chat Completions API

**ç«¯é»**: `https://api.openai.com/v1/chat/completions`

**è«‹æ±‚ç¯„ä¾‹**:
```json
{
  "model": "gpt-4o-mini",
  "messages": [
    {
      "role": "system",
      "content": "You are an expert lexicographer..."
    },
    {
      "role": "user",
      "content": "environment"
    }
  ],
  "response_format": { "type": "json_object" },
  "temperature": 0.2,
  "timeout": 20.0
}
```

**é€Ÿç‡é™åˆ¶**:
- **Tier 1**: 500 RPM (æ¯åˆ†é˜è«‹æ±‚æ•¸)
- **ä¸¦ç™¼ç­–ç•¥**: ä½¿ç”¨ `asyncio.Semaphore(477)` æ§åˆ¶
- **æˆæœ¬**: $0.15 / 1M input tokens, $0.60 / 1M output tokens
- **ä¼°ç®—**: 10,000 å–®å­—ç´„ $2-3 USD

---

#### 2. Text-to-Speech API

**ç«¯é»**: `https://api.openai.com/v1/audio/speech`

**è«‹æ±‚åƒæ•¸**:
```python
{
    "model": "gpt-4o-mini-tts",
    "voice": "onyx",
    "input": "environment",
    "response_format": "mp3"
}
```

**èªéŸ³é¸é …**:
- `alloy`: ä¸­æ€§
- `echo`: ç”·è²
- `fable`: è‹±å¼å£éŸ³
- `onyx`: ç”·è²ï¼Œæ¸…æ™° âœ… (æœ¬å°ˆæ¡ˆä½¿ç”¨)
- `nova`: å¥³è²
- `shimmer`: å¥³è²ï¼ŒæŸ”å’Œ

**æˆæœ¬ä¼°ç®—**:
- **å®šåƒ¹**: $15.00 / 1M characters
- **å¹³å‡é•·åº¦**: æ¯å–®å­—ç´„ 8 å­—å…ƒ
- **5,896 å€‹å–®å­—**: ç´„ 47,168 å­—å…ƒ = **$0.71 USD**

---

### Cloudflare R2 API

**ç›¸å®¹æ€§**: å®Œå…¨ç›¸å®¹ AWS S3 API

**èªè­‰æ–¹å¼**:
```python
s3 = boto3.client(
    's3',
    endpoint_url='https://<account_id>.r2.cloudflarestorage.com',
    aws_access_key_id='<access_key>',
    aws_secret_access_key='<secret_key>'
)
```

**å¸¸ç”¨æ“ä½œ**:
```python
# ä¸Šå‚³æª”æ¡ˆ
s3.upload_file(local_path, bucket_name, object_key)

# åˆ—å‡ºç‰©ä»¶
response = s3.list_objects_v2(Bucket=bucket_name, Prefix='prefix/')

# åˆªé™¤ç‰©ä»¶
s3.delete_object(Bucket=bucket_name, Key=object_key)

# å–å¾—ç‰©ä»¶ (åœ¨ Worker ä¸­)
const object = await env.AUDIO_BUCKET.get(objectKey);
```

**å®šåƒ¹**:
- **å„²å­˜**: $0.015 / GB / æœˆ (å…è²»é¡åº¦: 10 GB)
- **Class A æ“ä½œ** (å¯«å…¥): $4.50 / ç™¾è¬æ¬¡
- **Class B æ“ä½œ** (è®€å–): $0.36 / ç™¾è¬æ¬¡
- **å‡ºå£è²»ç”¨**: **$0** â­ (ç›¸æ¯” S3 ç¯€çœå¤§é‡æˆæœ¬)

---

## éƒ¨ç½²æŒ‡å—

### å‰ç½®æº–å‚™

**1. å®‰è£ Python ç’°å¢ƒ**:
```bash
# å»ºç«‹è™›æ“¬ç’°å¢ƒ
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£ä¾è³´
pip install pdfplumber spacy openai boto3 requests beautifulsoup4 tqdm python-dotenv
python -m spacy download en_core_web_sm
```

**2. è¨­å®šç’°å¢ƒè®Šæ•¸**:
å»ºç«‹ `.env` æª”æ¡ˆ:
```bash
OPENAI_API_KEY=sk-proj-...
R2_ACCOUNT_ID=your_account_id
R2_ACCESS_KEY_ID=your_access_key_id
R2_SECRET_ACCESS_KEY=your_secret_access_key
```

**3. å»ºç«‹ Cloudflare å¸³è™Ÿ**:
- è¨»å†Š [Cloudflare](https://dash.cloudflare.com/sign-up)
- å»ºç«‹ R2 Bucket: `vocab-audio`
- å–å¾— API Token

---

### å®Œæ•´éƒ¨ç½²æµç¨‹

#### æ­¥é©Ÿ 1: è³‡æ–™æ”¶é›†èˆ‡è™•ç†

```bash
# 1. ä¸‹è¼‰å­¸æ¸¬è©¦é¡Œ PDF
python ceec_scraper.py
# è¼¸å‡º: ceec_english_papers/*.pdf

# 2. æå–å–®å­—ä¸¦ç”Ÿæˆé‡‹ç¾©
python extract_words.py
# è¼¸å‡º: 
#   - data/raw_txt/*.txt (åŸå§‹æ–‡å­—)
#   - data/output/vocab_data.json (å–®å­—è³‡æ–™åº«)

# 3. (å¯é¸) ç·¨è¼¯å–®å­—è³‡æ–™
python json_edt.py
# äº’å‹•å¼åˆªé™¤ä¸éœ€è¦çš„å–®å­—

# 4. ç”Ÿæˆ TTS éŸ³é »
python enerate_tts_audio.py
# è¼¸å‡º: data/output/tts_audio/*.mp3 (5,896 å€‹æª”æ¡ˆ)
```

---

#### æ­¥é©Ÿ 2: éƒ¨ç½²éŸ³é »è‡³ R2

```bash
# ä¸Šå‚³éŸ³é »æª”æ¡ˆ
python r2_up.py
# ç¢ºä¿ç’°å¢ƒè®Šæ•¸å·²è¨­å®š
```

**æª¢æŸ¥ä¸Šå‚³çµæœ**:
```bash
# ä½¿ç”¨ rclone æˆ– Cloudflare Dashboard æª¢æŸ¥
# æ‡‰è©²çœ‹åˆ° 5,896 å€‹ MP3 æª”æ¡ˆ
```

---

#### æ­¥é©Ÿ 3: éƒ¨ç½² Cloudflare Worker

**å»ºç«‹ Worker å°ˆæ¡ˆ**:
```bash
# å®‰è£ Wrangler CLI
npm install -g wrangler

# ç™»å…¥ Cloudflare
wrangler login

# å»ºç«‹ wrangler.toml
cat > wrangler.toml << EOF
name = "vocab-audio"
main = "worker.js"
compatibility_date = "2024-01-01"

[[r2_buckets]]
binding = "AUDIO_BUCKET"
bucket_name = "vocab-audio"
EOF

# éƒ¨ç½² Worker
wrangler deploy
```

**æ¸¬è©¦ Worker**:
```bash
curl https://vocab-audio.your-account.workers.dev/environment.mp3
# æ‡‰è©²å›å‚³ MP3 éŸ³é »æª”æ¡ˆ
```

---

#### æ­¥é©Ÿ 4: éƒ¨ç½²å‰ç«¯è‡³ Cloudflare Pages

**æ–¹æ³• A: ä½¿ç”¨ Git (æ¨è–¦)**

```bash
# 1. åˆå§‹åŒ– Git å€‰åº«
git init
git add ç™¼è¡Œ/
git commit -m "Initial deploy"

# 2. æ¨é€è‡³ GitHub/GitLab
git remote add origin https://github.com/your-username/vocab-app.git
git push -u origin main

# 3. åœ¨ Cloudflare Dashboard:
#    - Pages â†’ Create a project
#    - é€£çµ Git å€‰åº«
#    - Build settings:
#      - Build command: (ç•™ç©º)
#      - Build output directory: ç™¼è¡Œ
#    - Deploy
```

**æ–¹æ³• B: ä½¿ç”¨ Wrangler CLI**

```bash
cd ç™¼è¡Œ
wrangler pages deploy . --project-name=vocab-app
```

**è‡ªè¨‚ç¶²åŸŸè¨­å®š** (å¯é¸):
```
1. åœ¨ Cloudflare Pages å°ˆæ¡ˆè¨­å®šä¸­
2. Custom domains â†’ Add a custom domain
3. è¼¸å…¥ä½ çš„ç¶²åŸŸ (ä¾‹å¦‚: vocab.example.com)
4. æŒ‰ç…§æŒ‡ç¤ºè¨­å®š DNS è¨˜éŒ„
```

---

#### æ­¥é©Ÿ 5: æ›´æ–°å‰ç«¯ Worker URL

**ç·¨è¼¯ `index.html`**:
```javascript
// ç¬¬ 352 è¡Œ
const workerBaseUrl = 'https://vocab-audio.your-account.workers.dev';
```

æ”¹ç‚ºæ‚¨å¯¦éš›çš„ Worker URLï¼Œç„¶å¾Œé‡æ–°éƒ¨ç½²ã€‚

---

### é©—è­‰éƒ¨ç½²

**æª¢æŸ¥æ¸…å–®**:

1. âœ… **å‰ç«¯å¯æ­£å¸¸è¨ªå•**
   - é–‹å•Ÿ `https://your-app.pages.dev`
   - æª¢æŸ¥æ˜¯å¦é¡¯ç¤ºå–®å­—åˆ—è¡¨

2. âœ… **è³‡æ–™è¼‰å…¥æˆåŠŸ**
   - é–‹å•Ÿç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12)
   - Network é ç±¤æ‡‰çœ‹åˆ° `vocab_data.json` æˆåŠŸè¼‰å…¥ (200 OK)

3. âœ… **æœå°‹èˆ‡ç¯©é¸åŠŸèƒ½**
   - æ¸¬è©¦æœå°‹æ¡†è¼¸å…¥
   - æ¸¬è©¦é »ç‡ç¯©é¸æŒ‰éˆ•
   - æ¸¬è©¦è©æ€§ç¯©é¸æŒ‰éˆ•

4. âœ… **éŸ³é »æ’­æ”¾åŠŸèƒ½**
   - é»æ“Šä»»æ„å–®å­—
   - é»æ“Šæ’­æ”¾æŒ‰éˆ•
   - æ‡‰è½åˆ°æ¸…æ™°çš„å–®å­—ç™¼éŸ³

5. âœ… **éŸ¿æ‡‰å¼è¨­è¨ˆ**
   - æ¸¬è©¦æ¡Œé¢ç€è¦½å™¨
   - æ¸¬è©¦æ‰‹æ©Ÿç€è¦½å™¨
   - æª¢æŸ¥ä½ˆå±€æ˜¯å¦æ­£ç¢º

---

## æˆæœ¬ä¼°ç®—

### ä¸€æ¬¡æ€§æˆæœ¬ (è³‡æ–™è™•ç†éšæ®µ)

| é …ç›® | æ•¸é‡ | å–®åƒ¹ | ç¸½è¨ˆ |
|------|------|------|------|
| OpenAI Chat Completions<br/>(ç”Ÿæˆé‡‹ç¾©) | ~10,000 å–®å­—<br/>ç´„ 20M tokens | Input: $0.15/1M<br/>Output: $0.60/1M | **~$3** |
| OpenAI TTS<br/>(ç”Ÿæˆç™¼éŸ³) | 5,896 å–®å­—<br/>ç´„ 47,168 å­—å…ƒ | $15/1M characters | **$0.71** |
| **ä¸€æ¬¡æ€§ç¸½è¨ˆ** | - | - | **~$4** |

### æœˆåº¦ç‡Ÿé‹æˆæœ¬ (å‡è¨­ 1,000 MAU)

| æœå‹™ | ç”¨é‡ä¼°ç®— | è¨ˆåƒ¹ | æœˆè²»ç”¨ |
|------|----------|------|--------|
| **Cloudflare Pages** | ç„¡é™è«‹æ±‚ | å…è²» | **$0** |
| **Cloudflare Workers** | ~50,000 éŸ³é »è«‹æ±‚<br/>(æ¯ç”¨æˆ¶ 50 æ¬¡æ’­æ”¾) | å…è²»é¡åº¦: 100k/day | **$0** |
| **Cloudflare R2 å„²å­˜** | ç´„ 500 MB | å…è²»é¡åº¦: 10 GB | **$0** |
| **R2 Class B æ“ä½œ**<br/>(è®€å–) | 50,000 æ¬¡ | $0.36 / ç™¾è¬æ¬¡ | **$0.02** |
| **R2 å‡ºå£æµé‡** | ~25 GB<br/>(500 MB Ã— 50 æ¬¡) | **$0 (å…è²»)** â­ | **$0** |
| **æœˆåº¦ç¸½è¨ˆ** | - | - | **~$0.02** |

### æ“´å±•æˆæœ¬ (å‡è¨­ 10,000 MAU)

| ç”¨æˆ¶æ•¸ | è«‹æ±‚æ•¸/æœˆ | Workers è²»ç”¨ | R2 è®€å–è²»ç”¨ | ç¸½è¨ˆ |
|--------|-----------|--------------|-------------|------|
| 1,000 | 50,000 | $0 | $0.02 | **$0.02** |
| 10,000 | 500,000 | $0 | $0.18 | **$0.18** |
| 100,000 | 5,000,000 | $0.50* | $1.80 | **$2.30** |

*Workers å…è²»é¡åº¦ç‚º 100,000 è«‹æ±‚/å¤© = 3,000,000/æœˆï¼Œè¶…å‡ºå¾Œ $0.50/ç™¾è¬æ¬¡

---

## ç³»çµ±ç‰¹è‰²ç¸½çµ

### æŠ€è¡“å„ªå‹¢

1. **å…¨è‡ªå‹•åŒ–æµç¨‹**
   - å¾è³‡æ–™æ”¶é›†åˆ°éƒ¨ç½²å…¨éƒ¨è‡ªå‹•åŒ–
   - é›¶äººå·¥æ¨™è¨»ï¼Œå…¨é  AI ç”Ÿæˆ
   - å¯è¼•é¬†æ“´å±•è‡³å…¶ä»–è€ƒè©¦æˆ–é ˜åŸŸ

2. **é«˜æ•ˆèƒ½æ¶æ§‹**
   - ç„¡ä¼ºæœå™¨æ¶æ§‹ï¼Œç„¡éœ€ç¶­è­·ä¼ºæœå™¨
   - å…¨çƒ CDN åˆ†ç™¼ï¼Œä½å»¶é²å­˜å–
   - æ™ºæ…§å¿«å–ç­–ç•¥ï¼Œæ¸›å°‘ API å‘¼å«

3. **æ¥µä½æˆæœ¬**
   - æœˆåº¦ç‡Ÿé‹æˆæœ¬è¶¨è¿‘æ–¼é›¶
   - ç„¡æµé‡è²»ç”¨ (R2 é›¶å‡ºå£è²»)
   - å…è²»é¡åº¦è¶³å¤ ä¸­å°å‹å°ˆæ¡ˆ

4. **å„ªç§€çš„ä½¿ç”¨è€…é«”é©—**
   - ç¾ä»£åŒ– UI è¨­è¨ˆ
   - éŸ¿æ‡‰å¼ä½ˆå±€
   - æµæš¢çš„å‹•ç•«æ•ˆæœ
   - é«˜å“è³ª AI èªéŸ³

5. **å¯æ“´å±•æ€§**
   - è³‡æ–™è™•ç†ç®¡ç·šå¯é‡è¤‡ä½¿ç”¨
   - è¼•é¬†æ–°å¢æ›´å¤šå–®å­—æˆ–è©¦é¡Œ
   - æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œæ˜“æ–¼ç¶­è­·

---

## æœªä¾†å„ªåŒ–æ–¹å‘

### åŠŸèƒ½å¢å¼·
- [ ] åŠ å…¥å–®å­—æ”¶è—åŠŸèƒ½ (localStorage)
- [ ] å­¸ç¿’é€²åº¦è¿½è¹¤
- [ ] å–®å­—å¡ç‰‡æ¨¡å¼ (Flashcard)
- [ ] æ¸¬é©—åŠŸèƒ½
- [ ] ä½¿ç”¨è€…å¸³è™Ÿç³»çµ±

### æ•ˆèƒ½å„ªåŒ–
- [ ] è™›æ“¬æ»¾å‹• (Virtual Scrolling)
- [ ] Service Worker é›¢ç·šæ”¯æ´
- [ ] åœ–ç‰‡ WebP æ ¼å¼ (å¦‚æœ‰åœ–ç‰‡)
- [ ] ä½¿ç”¨ IndexedDB å¿«å–è³‡æ–™

### è³‡æ–™å¢å¼·
- [ ] æ–°å¢æ›´å¤šè€ƒè©¦è³‡æ–™ (æŒ‡è€ƒã€çµ±æ¸¬)
- [ ] åŠ å…¥è©æº (Etymology)
- [ ] ç›¸é—œå–®å­—æ¨è–¦
- [ ] è©å½™é›£åº¦åˆ†ç´š (CEFR)

### å¤šèªè¨€æ”¯æ´
- [ ] ä»‹é¢å¤šèªè¨€ (è‹±æ–‡ã€æ—¥æ–‡)
- [ ] å¤šèªè¨€é‡‹ç¾©
- [ ] å¤šèªè¨€èªéŸ³

---

## å¸¸è¦‹å•é¡Œ (FAQ)

### Q1: ç‚ºä»€éº¼é¸æ“‡ Cloudflare è€Œä¸æ˜¯ AWS?
**A**: Cloudflare R2 çš„é›¶å‡ºå£è²»ç”¨èƒ½ç¯€çœå¤§é‡æˆæœ¬ï¼Œä¸” Worker èˆ‡ Pages çš„æ•´åˆéå¸¸é †æš¢ï¼Œéƒ¨ç½²ç°¡å–®ã€‚

### Q2: å¯ä»¥æ›´æ› TTS èªéŸ³å—?
**A**: å¯ä»¥ï¼Œåœ¨ `enerate_tts_audio.py` ä¸­ä¿®æ”¹ `TTS_VOICE` åƒæ•¸ï¼Œé¸é …åŒ…æ‹¬ `alloy`, `echo`, `fable`, `onyx`, `nova`, `shimmer`ã€‚

### Q3: å¦‚ä½•æ›´æ–°å–®å­—è³‡æ–™åº«?
**A**: 
1. é‡æ–°åŸ·è¡Œ `extract_words.py` è™•ç†æ–°çš„ PDF
2. åŸ·è¡Œ `python enerate_tts_audio.py` ç”Ÿæˆæ–°å–®å­—çš„éŸ³é »
3. åŸ·è¡Œ `python r2_up.py` ä¸Šå‚³æ–°éŸ³é »
4. å°‡æ–°çš„ `vocab_data.json` æ¨é€è‡³ Gitï¼Œè§¸ç™¼ Pages éƒ¨ç½²

### Q4: å¯ä»¥éƒ¨ç½²åœ¨å…¶ä»–å¹³å°å—?
**A**: å¯ä»¥ï¼Œå‰ç«¯å¯éƒ¨ç½²åœ¨ä»»ä½•éœæ…‹ç¶²ç«™è¨—ç®¡æœå‹™ (Vercel, Netlify)ï¼Œä½†éœ€è¦æ”¹å¯« Worker ç‚ºå°æ‡‰å¹³å°çš„ Serverless Functionã€‚

### Q5: ä¸¦ç™¼æ•¸ç‚ºä½•è¨­å®šç‚º 477?
**A**: é€™æ˜¯æ ¹æ“š OpenAI Tier 1 çš„é€Ÿç‡é™åˆ¶ (500 RPM) å¾®èª¿çš„ï¼Œä¿ç•™ä¸€äº›ç·©è¡é¿å…è§¸ç™¼é™åˆ¶ã€‚è«‹æ ¹æ“šæ‚¨çš„ Tier èª¿æ•´ã€‚

---

## æŠ€è¡“æ”¯æ´

### ç›¸é—œæ–‡ä»¶
- [Cloudflare Pages æ–‡ä»¶](https://developers.cloudflare.com/pages/)
- [Cloudflare Workers æ–‡ä»¶](https://developers.cloudflare.com/workers/)
- [Cloudflare R2 æ–‡ä»¶](https://developers.cloudflare.com/r2/)
- [OpenAI API æ–‡ä»¶](https://platform.openai.com/docs/)
- [spaCy æ–‡ä»¶](https://spacy.io/usage)

### é–‹æºå°ˆæ¡ˆè³‡è¨Š
- **å°ˆæ¡ˆåç¨±**: å­¸æ¸¬é«˜é »å–®å­—æ¢ç´¢ç³»çµ±
- **ç‰ˆæœ¬**: v7.0
- **æœ€å¾Œæ›´æ–°**: 2025-10-02
- **é–‹ç™¼è€…**: [æ‚¨çš„åç¨±]

---

## æˆæ¬Šè³‡è¨Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›æ•™è‚²èˆ‡å­¸ç¿’ç”¨é€”ã€‚

**è³‡æ–™ä¾†æº**:
- è©¦é¡Œè³‡æ–™: å¤§å­¸å…¥å­¸è€ƒè©¦ä¸­å¿ƒ (CEEC)
- AI æ¨¡å‹: OpenAI GPT-4o-mini & TTS
- NLP æ¨¡å‹: spaCy en_core_web_sm

**ç¬¬ä¸‰æ–¹æœå‹™**:
- Cloudflare Pages, Workers, R2
- OpenAI API
- Tailwind CSS
- Google Fonts

---

**æ–‡æª”çµæŸ** - ç¥æ‚¨éƒ¨ç½²é †åˆ©! ğŸš€


